<!DOCTYPE html>
<html lang="fr" class="scroll-smooth">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>9MM ‚Äî Challenge Fortnite 7 Jours</title>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com"></script>
<style>
:root{--red:#FF1717;--cyan:#00EDEF;--black:#0a0a0a}
body{font-family:'Inter',sans-serif;background:var(--black);color:#fff;margin:0;min-height:100vh;overflow-x:hidden}
.font-oswald{font-family:'Oswald',sans-serif}
@keyframes border-beam{0%{transform:translateY(-100%)}100%{transform:translateY(100vh)}}
@keyframes fadeSlideBlurIn{0%{opacity:0;transform:translateY(20px);filter:blur(8px)}100%{opacity:1;transform:translateY(0);filter:blur(0)}}
@keyframes flamePulse{0%,100%{transform:scale(1)}50%{transform:scale(1.15)}}
@keyframes unlockPop{0%{opacity:0;transform:scale(.3) rotate(-20deg)}60%{transform:scale(1.15) rotate(5deg)}100%{opacity:1;transform:scale(1) rotate(0deg)}}
@keyframes confettiDrop{0%{opacity:1;transform:translateY(0) rotate(0deg)}100%{opacity:0;transform:translateY(400px) rotate(720deg)}}
.fade-in{animation:fadeSlideBlurIn .8s cubic-bezier(.16,1,.3,1) both}
.delay-1{animation-delay:.15s}.delay-2{animation-delay:.3s}.delay-3{animation-delay:.45s}
*,*::before,*::after{box-sizing:border-box}
.form-group{display:flex;flex-direction:column;gap:6px}
.form-group label{font-size:11px;font-weight:600;letter-spacing:.08em;text-transform:uppercase;color:rgba(255,255,255,.4)}
.form-group input{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);color:#fff;padding:14px 16px;border-radius:12px;width:100%;font-size:16px;outline:none;transition:all .3s ease;backdrop-filter:blur(6px)}
.form-group input::placeholder{color:rgba(255,255,255,.25)}
.form-group input:focus{border-color:var(--cyan);background:rgba(255,255,255,.09);box-shadow:0 0 0 3px rgba(0,237,239,.1)}
.glass-card{background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08);border-radius:16px;backdrop-filter:blur(10px);overflow:hidden;position:relative}
.btn-cyan{background:linear-gradient(135deg,var(--cyan),#00b8ba);color:#000;font-weight:700;padding:16px;border-radius:12px;border:none;cursor:pointer;font-size:1.05rem;transition:all .3s;width:100%}
.btn-cyan:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(0,237,239,.3)}
@media(max-width:640px){.glass-card{border-radius:12px}main{padding-left:16px;padding-right:16px}}

.day-card{border-radius:16px;padding:20px 24px;transition:all .3s;cursor:pointer;position:relative;overflow:hidden}
.day-card.locked{background:rgba(255,255,255,.02);border:1px solid rgba(255,255,255,.04);opacity:.35;cursor:default}
.day-card.available{background:rgba(0,237,239,.03);border:1px dashed rgba(0,237,239,.15)}
.day-card.available:hover{background:rgba(0,237,239,.06);border-color:rgba(0,237,239,.3);transform:translateY(-2px)}
.day-card.completed{background:rgba(0,237,239,.06);border:1px solid rgba(0,237,239,.2)}
.day-card.active{background:rgba(0,237,239,.08);border:2px solid rgba(0,237,239,.35);box-shadow:0 0 40px rgba(0,237,239,.1)}

.bonus-card{background:linear-gradient(135deg,rgba(0,237,239,.04),rgba(0,237,239,.01));border:1px solid rgba(0,237,239,.12);border-radius:12px;padding:14px 18px;margin-top:12px}

.check-item{display:flex;align-items:flex-start;gap:10px;padding:10px 14px;border-radius:10px;cursor:pointer;transition:all .2s;user-select:none;-webkit-user-select:none}
.check-item.unchecked{background:rgba(255,255,255,.02);border:1px solid rgba(255,255,255,.06)}
.check-item.unchecked:hover{background:rgba(255,255,255,.04)}
.check-item.checked{background:rgba(0,237,239,.08);border:1px solid rgba(0,237,239,.15)}
.check-box{width:22px;height:22px;border-radius:6px;border:2px solid rgba(255,255,255,.15);display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:all .2s;margin-top:2px}
.check-item.checked .check-box{background:var(--cyan);border-color:var(--cyan)}

.streak-flame{animation:flamePulse 1.5s ease infinite}
.progress-ring{transition:stroke-dashoffset .8s cubic-bezier(.16,1,.3,1)}

#confetti-container{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:999;overflow:hidden}
.confetti-piece{position:absolute;width:10px;height:10px;animation:confettiDrop 2s ease-in forwards}
</style>
</head>
<body>
<div class="fixed z-0 pointer-events-none flex max-w-6xl border-x border-white/5 mx-auto px-4 top-0 right-0 bottom-0 left-0 justify-between">
<div class="w-px h-full bg-white/5 relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-[200px] bg-gradient-to-b from-transparent via-[rgba(0,237,239,.4)] to-transparent animate-[border-beam_5s_linear_infinite]"></div></div>
<div class="w-px h-full bg-white/5 hidden md:block relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-[200px] bg-gradient-to-b from-transparent via-[rgba(0,237,239,.4)] to-transparent animate-[border-beam_7s_linear_infinite_2s]"></div></div>
<div class="w-px h-full bg-white/5 hidden lg:block relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-[200px] bg-gradient-to-b from-transparent via-[rgba(0,237,239,.4)] to-transparent animate-[border-beam_5s_linear_infinite_4s]"></div></div>
<div class="w-px h-full bg-white/5 relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-[200px] bg-gradient-to-b from-transparent via-[rgba(0,237,239,.4)] to-transparent animate-[border-beam_8s_linear_infinite_1s]"></div></div>
</div>

<div id="confetti-container"></div>

<header class="relative z-10 text-center pt-10 pb-4">
<div class="inline-flex items-center gap-3"><span class="font-oswald text-3xl font-bold tracking-wider">9MM</span><span class="text-[10px] text-white/30 tracking-[.3em] uppercase mt-1">Beyond &#9733; Energy</span></div>
<div style="width:50px;height:3px;background:linear-gradient(90deg,var(--red),var(--cyan));margin:10px auto 0;border-radius:99px"></div>
</header>

<main class="max-w-3xl mx-auto px-5 pb-16 relative z-10">

<!-- ============ EMAIL GATE ============ -->
<div id="gate-screen" class="fade-in">
<div class="text-center mb-8">
<span class="inline-block text-xs tracking-[.3em] uppercase px-3 py-1 rounded-full mb-4" style="background:rgba(0,237,239,.08);color:var(--cyan);border:1px solid rgba(0,237,239,.15)">CHALLENGE FORTNITE</span>
<h1 class="font-oswald text-4xl md:text-6xl font-bold uppercase leading-[.85] mb-3">Challenge Fortnite<br/><span style="color:var(--cyan)">7 Jours pour Devenir<br/>Meilleur</span></h1>
<p class="text-white/45 max-w-lg mx-auto mb-2 text-base">Entraine-toi comme les meilleurs (<strong class="text-white/70">Peterbot</strong>, <strong class="text-white/70">Ajerss</strong>, <strong class="text-white/70">Pollo</strong>...)</p>
<p class="text-white/25 text-sm">7 jours. 7 missions. Progression garantie.</p>
</div>

<div class="grid sm:grid-cols-3 gap-3 mb-8">
<div class="glass-card p-4 text-center fade-in delay-1">
<span style="font-size:28px">üéØ</span>
<h3 class="font-oswald text-sm font-bold mt-2 uppercase">Build & Edit</h3>
<p class="text-white/30 text-[10px] mt-1">Freebuild, triple edits, retakes</p>
</div>
<div class="glass-card p-4 text-center fade-in delay-2">
<span style="font-size:28px">üî•</span>
<h3 class="font-oswald text-sm font-bold mt-2 uppercase">W-Key & Combat</h3>
<p class="text-white/30 text-[10px] mt-1">Realistic 1v1, piece control, aim</p>
</div>
<div class="glass-card p-4 text-center fade-in delay-3">
<span style="font-size:28px">üß†</span>
<h3 class="font-oswald text-sm font-bold mt-2 uppercase">VOD & Analyse</h3>
<p class="text-white/30 text-[10px] mt-1">Review de replays, mental game</p>
</div>
</div>

<!-- Email gate FIRST -->
<div class="glass-card p-8 text-center fade-in delay-2" style="border-color:rgba(0,237,239,.1);box-shadow:0 0 60px rgba(0,237,239,.06)">
<p class="font-oswald text-xl font-bold uppercase mb-1">Commence le challenge</p>
<p class="text-white/35 text-sm mb-6">Gratuit. Progres sauvegardes. Pas de spam.</p>
<form id="lead-form" onsubmit="captureEmail(event)" class="space-y-4 max-w-xs mx-auto">
<div class="form-group"><label>Ton pseudo / prenom</label><input type="text" name="name" placeholder="Ton pseudo Fortnite" required/></div>
<div class="form-group"><label>Ton email</label><input type="email" name="email" placeholder="Ton email" required/></div>
<button type="submit" class="btn-cyan">COMMENCER LE CHALLENGE &rarr;</button>
</form>
<div class="flex items-center gap-3 mt-5 justify-center">
<div class="flex -space-x-2">
<div class="w-6 h-6 rounded-full bg-white/10 border-2 border-black flex items-center justify-center text-[9px]">üéÆ</div>
<div class="w-6 h-6 rounded-full bg-white/10 border-2 border-black flex items-center justify-center text-[9px]">üèÜ</div>
<div class="w-6 h-6 rounded-full bg-white/10 border-2 border-black flex items-center justify-center text-[9px]">‚ö°</div>
</div>
<span class="text-white/20 text-xs">3,200+ joueurs inscrits</span>
</div>
</div>

<!-- Apercu du challenge EN DESSOUS du formulaire -->
<div class="glass-card p-5 mt-6 fade-in delay-3">
<h3 class="font-oswald text-sm font-bold uppercase mb-3 text-white/50">Apercu du challenge</h3>
<div class="space-y-2">
<div class="flex items-center gap-3 text-sm"><span class="font-oswald font-bold text-cyan-400 w-8">J1</span><span class="text-white/50">Fondations et Mecaniques (15 min)</span></div>
<div class="flex items-center gap-3 text-sm"><span class="font-oswald font-bold text-cyan-400 w-8">J2</span><span class="text-white/50">Le Grind du Realistic (10 Rounds)</span></div>
<div class="flex items-center gap-3 text-sm"><span class="font-oswald font-bold text-cyan-400 w-8">J3</span><span class="text-white/50">Agressivite Maximale (3 Games)</span></div>
<div class="flex items-center gap-3 text-sm"><span class="font-oswald font-bold text-cyan-400 w-8">J4</span><span class="text-white/50">Fluidite et Constance</span></div>
<div class="flex items-center gap-3 text-sm"><span class="font-oswald font-bold text-cyan-400 w-8">J5</span><span class="text-white/50">Analyse et VOD Review (20 min)</span></div>
<div class="flex items-center gap-3 text-sm"><span class="font-oswald font-bold text-cyan-400 w-8">J6</span><span class="text-white/50">Maitrise du Piece Control</span></div>
<div class="flex items-center gap-3 text-sm"><span class="font-oswald font-bold text-cyan-400 w-8">J7</span><span class="text-white/50">Le Test Final (Ranked)</span></div>
</div>
</div>

<!-- Placeholder: Image/Video tips -->
<div class="glass-card p-4 mt-6 fade-in delay-3" style="border-color:rgba(0,237,239,.06)">
<div class="flex items-center gap-3 mb-3">
<span class="text-lg">&#127909;</span>
<h3 class="font-oswald text-xs font-bold uppercase text-white/40">Tips en action</h3>
</div>
<div class="grid grid-cols-2 gap-3">
<div class="rounded-xl flex items-center justify-center" style="background:rgba(0,237,239,.03);border:1px dashed rgba(0,237,239,.1);aspect-ratio:16/9">
<div class="text-center"><span class="text-2xl block mb-1">&#9654;&#65039;</span><span class="text-[9px] text-white/20">Video: Triple Edit Technique</span></div>
</div>
<div class="rounded-xl flex items-center justify-center" style="background:rgba(0,237,239,.03);border:1px dashed rgba(0,237,239,.1);aspect-ratio:16/9">
<div class="text-center"><span class="text-2xl block mb-1">&#9654;&#65039;</span><span class="text-[9px] text-white/20">Video: Piece Control Basics</span></div>
</div>
</div>
<p class="text-white/15 text-[9px] mt-2">TODO: Remplacer par des videos/images de tips Fortnite</p>
</div>

<!-- Placeholder: 9MM gaming setup -->
<div class="glass-card p-4 mt-4 fade-in delay-3" style="border-color:rgba(0,237,239,.06)">
<div class="rounded-xl flex items-center justify-center" style="background:linear-gradient(135deg,rgba(0,237,239,.04),rgba(0,237,239,.01));border:1px dashed rgba(0,237,239,.1);aspect-ratio:16/9;max-height:160px">
<div class="text-center px-4">
<span class="font-oswald text-base font-bold block mb-1" style="color:var(--cyan)">9MM</span>
<span class="text-[10px] text-white/30">Photo: canette 9MM Active Mind sur un setup gaming</span>
<span class="text-[8px] text-white/15 block mt-1">TODO: Ajouter image produit en contexte</span>
</div>
</div>
</div>
</div>

<!-- ============ CHALLENGE TRACKER ============ -->
<div id="tracker-screen" style="display:none">

<!-- Streak header -->
<div class="text-center mb-6">
<div class="streak-flame" style="font-size:48px" id="flame-icon">üî•</div>
<span class="font-oswald text-5xl font-bold" style="color:var(--cyan)" id="streak-count">0</span>
<span class="text-white/30 text-sm block mt-1">jours completes</span>
<div class="h-1.5 rounded-full bg-white/5 max-w-xs mx-auto mt-3 overflow-hidden">
<div id="streak-bar" class="h-full rounded-full" style="width:0%;background:linear-gradient(90deg,var(--cyan),#00b8ba);transition:width .5s"></div>
</div>
<span class="text-[10px] text-white/20 mt-1 block" id="streak-label">0 / 7 jours</span>
</div>

<!-- Day cards -->
<div class="space-y-3" id="days-container"></div>

<!-- Expanded day detail -->
<div id="day-detail" style="display:none" class="mt-6">
<div class="glass-card p-6" style="border-color:rgba(0,237,239,.12);box-shadow:0 0 40px rgba(0,237,239,.06)">
<div class="flex items-center justify-between mb-4">
<div>
<span class="text-[10px] tracking-[.2em] uppercase text-cyan-400 font-semibold" id="detail-tag">JOUR 1</span>
<h3 class="font-oswald text-xl font-bold uppercase mt-1" id="detail-title">-</h3>
</div>
<button onclick="closeDetail()" class="w-8 h-8 rounded-full bg-white/5 flex items-center justify-center text-white/30 hover:text-white/60 transition text-sm border-0 cursor-pointer">&times;</button>
</div>
<div id="detail-content" class="text-white/55 text-sm leading-relaxed mb-5"></div>
<div id="detail-bonus" class="bonus-card mb-5" style="display:none">
<div class="flex items-start gap-2">
<span style="font-size:18px">üéÅ</span>
<div>
<strong class="text-cyan-400 text-xs uppercase tracking-wider">Bonus 9MM</strong>
<p class="text-white/50 text-sm mt-1" id="bonus-text"></p>
</div>
</div>
</div>
<div class="space-y-2" id="detail-tasks"></div>
<div class="mt-4 text-center">
<button id="validate-day-btn" onclick="validateDay()" class="btn-cyan" style="max-width:280px;margin:0 auto" disabled>VALIDER JOUR <span id="validate-day-num">1</span> &rarr;</button>
<p class="text-[10px] text-white/20 mt-2">Complete toutes les taches pour valider</p>
</div>
</div>
</div>

<!-- Completion screen -->
<div id="completion-screen" style="display:none" class="mt-8 text-center">
<div class="glass-card p-10" style="border-color:rgba(0,237,239,.15);box-shadow:0 0 60px rgba(0,237,239,.08)">
<div style="font-size:72px;margin-bottom:12px">üèÜ</div>
<h2 class="font-oswald text-3xl md:text-4xl font-bold uppercase mb-2" style="color:var(--cyan)">Challenge Complete !</h2>
<p class="text-white/50 mb-6">Tu as termine les 7 jours. Tes mecaniques, ton aim et ton game sense ont monte d'un cran.</p>
<div class="glass-card p-5 text-left max-w-sm mx-auto mb-6">
<strong class="text-sm block mb-2">Ton 9MM recommande</strong>
<div class="flex items-center gap-3">
<div class="w-[40px] h-[65px] rounded-lg flex items-center justify-center shrink-0" style="background:rgba(0,237,239,.08);border:1px solid rgba(0,237,239,.12)"><span class="font-oswald text-sm font-bold" style="color:var(--cyan)">9MM</span></div>
<div><strong class="text-sm" style="color:var(--cyan)">Active Mind</strong><p class="text-white/35 text-xs mt-0.5">The vert + Guarana pour des reflexes et une vigilance au top pendant tes sessions.</p></div>
</div>
</div>
<a href="https://9mm-energy.com" class="btn-cyan inline-block px-8" style="max-width:300px">DECOUVRIR 9MM ACTIVE MIND &rarr;</a>
</div>
</div>
</div>

<!-- Product section -->
<section class="max-w-3xl mx-auto px-5 mt-16 mb-8 relative z-10">
<div class="text-center mb-6">
<span class="inline-block text-[10px] tracking-[.3em] uppercase px-3 py-1 rounded-full mb-3" style="background:rgba(0,237,239,.06);color:var(--cyan);border:1px solid rgba(0,237,239,.1)">TON BOOST GAMING</span>
<h2 class="font-oswald text-2xl md:text-3xl font-bold uppercase leading-[.9]">Reflexes. Focus.<br/><span style="color:var(--cyan)">Zero Crash.</span></h2>
</div>
<div class="glass-card p-5" style="border-color:rgba(0,237,239,.1)">
<div class="flex items-center gap-4 mb-3">
<div class="w-[56px] h-[80px] rounded-lg flex items-center justify-center shrink-0" style="background:linear-gradient(180deg,rgba(0,237,239,.1),rgba(0,237,239,.02));border:1px solid rgba(0,237,239,.12)"><span class="font-oswald text-base font-bold" style="color:var(--cyan)">9MM</span></div>
<div><h3 class="font-oswald text-base font-bold uppercase">Active Mind</h3><p class="text-white/35 text-[11px] mt-0.5">Concentration & reflexes gaming</p></div>
</div>
<div class="flex flex-wrap gap-1.5 mb-2">
<span class="text-[9px] px-2 py-0.5 rounded-full" style="background:rgba(0,237,239,.06);color:var(--cyan);border:1px solid rgba(0,237,239,.08)">The Vert</span>
<span class="text-[9px] px-2 py-0.5 rounded-full" style="background:rgba(0,237,239,.06);color:var(--cyan);border:1px solid rgba(0,237,239,.08)">Guarana</span>
<span class="text-[9px] px-2 py-0.5 rounded-full" style="background:rgba(0,237,239,.06);color:var(--cyan);border:1px solid rgba(0,237,239,.08)">Ginseng</span>
<span class="text-[9px] px-2 py-0.5 rounded-full" style="background:rgba(0,237,239,.06);color:var(--cyan);border:1px solid rgba(0,237,239,.08)">Vitamines B</span>
</div>
<p class="text-[10px] text-white/25">250ml &middot; 0g sucre &middot; Made in Switzerland</p>
</div>
</section>
</main>

<footer class="relative z-10 text-center py-8 mt-8">
<div class="max-w-md mx-auto border-t border-white/5 pt-6"><span class="font-oswald text-lg font-bold text-white/40">9MM</span><span class="text-[9px] text-white/20 tracking-[.2em] uppercase ml-2">Beyond Energy</span><p class="text-white/20 text-xs mt-2">&copy; 2026 9MM Suisse SA</p></div>
</footer>

<script>
const STORAGE_KEY = '9mm-fortnite-challenge';

const challenge = [
  {
    day: 1,
    title: 'Fondations et Mecaniques',
    duration: '15 min',
    content: 'Ne construis pas au hasard. Fais 5 min de freebuild (triple edits, retakes) et 10 min de Aim Trainer (tracking et reflexes au pompe) sur une map de Raider464.',
    bonus: 'Pour bien ameliorer tes reflexes, tu peux miser sur une boisson comme la 9MM Active Mind : ses extraits de The Vert et de Guarana aident a soutenir la vigilance necessaire pour ne rater aucun edit.',
    tasks: ['5 min de freebuild (triple edits + retakes)', '10 min de Aim Trainer sur map Raider464', 'Focus tracking + reflexes au pompe']
  },
  {
    day: 2,
    title: 'Le Grind du Realistic',
    duration: '10 Rounds',
    content: 'Utilise le mode Realistic 1v1. C\'est le meilleur moyen de simuler des combats de fin de partie. Focus sur le gain de hauteur et le placement de tes builds avant l\'adversaire.',
    bonus: null,
    tasks: ['10 rounds en Realistic 1v1', 'Focus gain de hauteur a chaque fight', 'Placement de builds AVANT l\'adversaire', 'Note tes erreurs apres chaque round']
  },
  {
    day: 3,
    title: 'Agressivite Maximale',
    duration: '3 Games',
    content: 'Active le mode "W-Key". Ne campe pas, ne farme pas pendant 20 minutes. Des que tu as un pompe, fonce sur chaque bruit de tir pour t\'habituer a la pression du combat en jeu reel.',
    bonus: 'Pour maintenir une lucidite constante meme dans le chaos, les vitamines B (B3, B5, B6, B12) et le magnesium de 9MM Active Mind sont tes allies pour reduire la fatigue mentale.',
    tasks: ['3 games en mode W-Key total', 'Rush chaque bruit de tir', 'Zero camping, zero farm inutile', 'Minimum 5 eliminations par game']
  },
  {
    day: 4,
    title: 'Fluidite et Constance',
    duration: '20 min',
    content: 'Travaille ton crosshair placement. Sois regulier dans tes mouvements, evite les gestes inutiles et surtout, arrete de camper dans des box. C\'est toi qui dois imposer le rythme.',
    bonus: null,
    tasks: ['20 min de crosshair placement drills', 'Zero gestes inutiles (mouvement propre)', 'Impose ton rythme dans chaque fight', 'Pas de box camping']
  },
  {
    day: 5,
    title: 'Analyse et VOD Review',
    duration: '20 min',
    content: 'Regarde tes propres replays ou ceux de pros comme Pollo. Identifie chaque erreur de placement ou chaque decision tardive qui t\'a coute la vie.',
    bonus: null,
    tasks: ['Review 2-3 de tes replays recents', 'Identifie tes erreurs de placement', 'Note chaque decision tardive', 'Regarde 1 VOD d\'un pro (Pollo, Peterbot)']
  },
  {
    day: 6,
    title: 'Maitrise du Piece Control',
    duration: '15-20 min',
    content: 'Passe 15 a 20 minutes sur une map de Piece Control. L\'objectif est d\'automatiser l\'enfermement de l\'adversaire (murs, cones) avant meme de tirer.',
    bonus: null,
    tasks: ['15-20 min sur map Piece Control', 'Automatise murs + cones autour de l\'ennemi', 'Enferme AVANT de tirer', 'Enchaine 3 piece controls propres d\'affilee']
  },
  {
    day: 7,
    title: 'Le Test Final (Ranked)',
    duration: '5-10 Games',
    content: 'Applique tout ce que tu as appris. Joue 5 a 10 parties en restant calme et methodique. Analyse si ton tracking est plus propre et si tes prises de decisions sont plus rapides.',
    bonus: null,
    tasks: ['5-10 games en Ranked', 'Reste calme et methodique', 'Applique TOUT ce que tu as appris (J1-J6)', 'Evalue ta progression : tracking + decision-making']
  }
];

let data = JSON.parse(localStorage.getItem(STORAGE_KEY) || 'null');
let currentDetailDay = null;

function save() { localStorage.setItem(STORAGE_KEY, JSON.stringify(data)); }

function captureEmail(e) {
  e.preventDefault();
  const fd = new FormData(e.target);
  const d = {}; fd.forEach((v, k) => d[k] = v);
  d.source = 'challenge-fortnite-7j';
  d.timestamp = new Date().toISOString();
  console.log('9MM Lead captured:', d);
  // TODO: API call
  if (!data) {
    data = { startDate: new Date().toISOString().split('T')[0], days: {}, name: d.name };
  }
  save();
  document.getElementById('gate-screen').style.display = 'none';
  document.getElementById('tracker-screen').style.display = 'block';
  render();
}

// Check if already started
if (data) {
  document.getElementById('gate-screen').style.display = 'none';
  document.getElementById('tracker-screen').style.display = 'block';
  setTimeout(render, 100);
}

function render() {
  const completedCount = Object.values(data.days).filter(d => d.validated).length;

  // Streak
  document.getElementById('streak-count').textContent = completedCount;
  document.getElementById('streak-bar').style.width = (completedCount / 7 * 100) + '%';
  document.getElementById('streak-label').textContent = completedCount + ' / 7 jours';

  // Flame size
  const flame = document.getElementById('flame-icon');
  flame.style.fontSize = Math.max(36, 36 + completedCount * 4) + 'px';

  // Day cards
  const container = document.getElementById('days-container');
  container.innerHTML = '';

  challenge.forEach((ch, i) => {
    const dayNum = i + 1;
    const dayKey = 'day-' + dayNum;
    const isCompleted = data.days[dayKey] && data.days[dayKey].validated;
    const prevCompleted = dayNum === 1 || (data.days['day-' + (dayNum - 1)] && data.days['day-' + (dayNum - 1)].validated);
    const isAvailable = prevCompleted && !isCompleted;

    const card = document.createElement('div');
    card.className = 'day-card ' + (isCompleted ? 'completed' : isAvailable ? 'available' : 'locked');
    card.innerHTML = `
      <div class="flex items-center gap-4">
        <div class="w-12 h-12 rounded-xl flex items-center justify-center shrink-0 font-oswald text-lg font-bold"
             style="background:${isCompleted ? 'rgba(0,237,239,.15)' : 'rgba(255,255,255,.04)'};color:${isCompleted ? 'var(--cyan)' : 'rgba(255,255,255,.2)'}">
          ${isCompleted ? '&#10003;' : 'J' + dayNum}
        </div>
        <div class="flex-1 min-w-0">
          <div class="flex items-center gap-2">
            <h3 class="font-oswald text-sm font-bold uppercase truncate">${ch.title}</h3>
            <span class="text-[10px] px-2 py-0.5 rounded-full shrink-0" style="background:rgba(0,237,239,.06);color:var(--cyan);border:1px solid rgba(0,237,239,.1)">${ch.duration}</span>
          </div>
          <p class="text-white/30 text-xs mt-1 truncate">${isCompleted ? 'Complete &#10003;' : ch.content.substring(0, 60) + '...'}</p>
        </div>
        ${isAvailable ? '<span class="text-cyan-400 text-sm shrink-0">&rarr;</span>' : ''}
      </div>
    `;

    if (isAvailable) {
      card.onclick = () => openDetail(dayNum);
    }

    container.appendChild(card);
  });

  // Check completion
  if (completedCount >= 7) {
    document.getElementById('completion-screen').style.display = 'block';
    launchConfetti();
  }
}

function openDetail(dayNum) {
  currentDetailDay = dayNum;
  const ch = challenge[dayNum - 1];
  const detail = document.getElementById('day-detail');

  document.getElementById('detail-tag').textContent = 'JOUR ' + dayNum + ' ‚Äî ' + ch.duration;
  document.getElementById('detail-title').textContent = ch.title;
  document.getElementById('detail-content').textContent = ch.content;
  document.getElementById('validate-day-num').textContent = dayNum;

  // Bonus
  const bonusEl = document.getElementById('detail-bonus');
  if (ch.bonus) {
    bonusEl.style.display = 'block';
    document.getElementById('bonus-text').textContent = ch.bonus;
  } else {
    bonusEl.style.display = 'none';
  }

  // Tasks
  const tasksEl = document.getElementById('detail-tasks');
  tasksEl.innerHTML = '';
  ch.tasks.forEach((t, i) => {
    const item = document.createElement('div');
    item.className = 'check-item unchecked';
    item.dataset.idx = i;
    item.onclick = () => toggleTask(item);
    item.innerHTML = `<div class="check-box"></div><span class="text-sm">${t}</span>`;
    tasksEl.appendChild(item);
  });

  document.getElementById('validate-day-btn').disabled = true;
  detail.style.display = 'block';
  detail.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

function closeDetail() {
  document.getElementById('day-detail').style.display = 'none';
  currentDetailDay = null;
}

function toggleTask(el) {
  const isChecked = el.classList.contains('checked');
  if (isChecked) {
    el.className = 'check-item unchecked';
    el.querySelector('.check-box').innerHTML = '';
  } else {
    el.className = 'check-item checked';
    el.querySelector('.check-box').innerHTML = '<span style="color:#000;font-size:12px">&#10003;</span>';
  }

  const total = document.querySelectorAll('#detail-tasks .check-item').length;
  const checked = document.querySelectorAll('#detail-tasks .check-item.checked').length;
  document.getElementById('validate-day-btn').disabled = checked < total;
}

function validateDay() {
  if (!currentDetailDay) return;
  const dayKey = 'day-' + currentDetailDay;
  data.days[dayKey] = { validated: true, time: new Date().toISOString() };
  save();
  closeDetail();
  render();
  miniConfetti();
}

function launchConfetti() {
  const container = document.getElementById('confetti-container');
  const colors = ['#00EDEF', '#FF1717', '#FFD700', '#fff', '#00b8ba'];
  for (let i = 0; i < 60; i++) {
    const piece = document.createElement('div');
    piece.className = 'confetti-piece';
    piece.style.left = Math.random() * 100 + '%';
    piece.style.top = '-10px';
    piece.style.background = colors[Math.floor(Math.random() * colors.length)];
    piece.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
    piece.style.width = (6 + Math.random() * 8) + 'px';
    piece.style.height = (6 + Math.random() * 8) + 'px';
    piece.style.animationDelay = (Math.random() * 1.5) + 's';
    piece.style.animationDuration = (1.5 + Math.random() * 1.5) + 's';
    container.appendChild(piece);
  }
  setTimeout(() => { container.innerHTML = ''; }, 4000);
}

function miniConfetti() {
  const container = document.getElementById('confetti-container');
  const colors = ['#00EDEF', '#00b8ba', '#fff'];
  for (let i = 0; i < 20; i++) {
    const piece = document.createElement('div');
    piece.className = 'confetti-piece';
    piece.style.left = (30 + Math.random() * 40) + '%';
    piece.style.top = '-10px';
    piece.style.background = colors[Math.floor(Math.random() * colors.length)];
    piece.style.borderRadius = '50%';
    piece.style.width = (4 + Math.random() * 6) + 'px';
    piece.style.height = (4 + Math.random() * 6) + 'px';
    piece.style.animationDelay = (Math.random() * .5) + 's';
    piece.style.animationDuration = (1 + Math.random() * 1) + 's';
    container.appendChild(piece);
  }
  setTimeout(() => { container.innerHTML = ''; }, 2500);
}
</script>
</body>
</html>
